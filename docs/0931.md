# 集合映射中的映射包(使用 xml 文件)

> 原文：<https://www.javatpoint.com/mapping-bag-in-collection-mapping>

1.  [集合映射中的映射包](#)
2.  [集合映射中的映射包示例](#ex)

如果我们的持久类有 list 对象，我们可以通过映射文件中的 List 或 bag 元素来映射 List。包就像列表一样，但不需要索引元素。

这里我们使用的是论坛的场景，一个问题有多个答案。

![Mapping Bag in hibernate](../img/8429a68cc141075f5bb0a95acfa5ee64.png)

让我们看看如何在映射文件中实现包:

```java

<class name="com.javatpoint.Question" table="q100">
       ...      
          <bag name="answers" table="ans100">
          <key column="qid"></key>
          <element column="answer" type="string"></element>
          </bag>

       ...
</class>

```

* * *

### 集合映射中的映射包示例

在本例中，我们将看到通过包进行集合映射的完整示例。这是包的例子，如果它存储的是值而不是实体引用，这就是为什么我们要使用**元素**而不是**一对多**。如果你看过映射列表的例子，它在所有情况下都是一样的，而不是映射文件，我们使用的是包而不是列表。

### 1)创建持久类

这个持久类定义了包括列表在内的类的属性。

```java

package com.javatpoint;

import java.util.List;

public class Question {
private int id;
private String qname;
private List answers;

//getters and setters

} 
```

* * *

### 2)为持久类创建映射文件

这里，我们已经创建了用于定义列表的 question.hbm.xml 文件。

```java

<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE hibernate-mapping PUBLIC
          "-//Hibernate/Hibernate Mapping DTD 5.3//EN"
          "http://hibernate.sourceforge.net/hibernate-mapping-5.3.dtd">

<hibernate-mapping>
 <class name="com.javatpoint.Question" table="q101">
   <id name="id">
     <generator class="increment"></generator>
   </id>
   <property name="qname"></property>

   <bag name="answers" table="ans101">
     <key column="qid"></key>
     <element column="answer" type="string"></element>
   </bag>

 </class>

</hibernate-mapping>

```

* * *

### 3)创建配置文件

该文件包含有关数据库和映射文件的信息。

```java

<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE hibernate-configuration PUBLIC
          "-//Hibernate/Hibernate Configuration DTD 5.3//EN"
          "http://hibernate.sourceforge.net/hibernate-configuration-5.3.dtd">

<!-- Generated by MyEclipse Hibernate Tools.                   -->
<hibernate-configuration>

    <session-factory>
        <property name="hbm2ddl.auto">update</property>
        <property name="dialect">org.hibernate.dialect.Oracle9Dialect</property>
        <property name="connection.url">jdbc:oracle:thin:@localhost:1521:xe</property>
        <property name="connection.username">system</property>
        <property name="connection.password">jtp</property>
        <property name="connection.driver_class">oracle.jdbc.driver.OracleDriver</property>
    <mapping resource="question.hbm.xml"/>
    </session-factory>

</hibernate-configuration>

```

* * *

### 4)创建存储数据的类

在这门课上，我们存储了问题类的数据。

```java

package com.javatpoint;  

import java.util.ArrayList;  

import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.hibernate.Transaction;
import org.hibernate.boot.Metadata;
import org.hibernate.boot.MetadataSources;
import org.hibernate.boot.registry.StandardServiceRegistry;
import org.hibernate.boot.registry.StandardServiceRegistryBuilder;

public class StoreData {  
 public static void main(String[] args) {  

	 StandardServiceRegistry ssr=new StandardServiceRegistryBuilder().configure("hibernate.cfg.xml").build();
	 Metadata meta=new MetadataSources(ssr).getMetadataBuilder().build();

	 SessionFactory factory=meta.buildSessionFactory();
	 Session session=factory.openSession();

    Transaction t=session.beginTransaction();  

    ArrayList<String> list1=new ArrayList<String>();  
    list1.add("Java is a programming language");  
    list1.add("Java is a platform");  

    ArrayList<String> list2=new ArrayList<String>();  
    list2.add("Servlet is an Interface");  
    list2.add("Servlet is an API");  

    Question question1=new Question();  
    question1.setQname("What is Java?");  
    question1.setAnswers(list1);  

    Question question2=new Question();  
    question2.setQname("What is Servlet?");  
    question2.setAnswers(list2);  

    session.persist(question1);  
    session.persist(question2);  

    t.commit();  
    session.close();  
    System.out.println("success");  
 }  
}  

```

### 输出

![Hibernate Mapping Bag Example 1](../img/3ac8b68eed5e706dd12fd82d825c3e85.png) ![Hibernate Mapping Bag Example 2](../img/62da243294ff22f040a6c682dbb7db21.png)

### 如何获取数据

在这里，我们使用 HQL 来获取问题类的所有记录，包括答案。在这种情况下，它从两个功能相关的表中获取数据。

```java

package com.javatpoint;  

import javax.persistence.TypedQuery;
import java.util.*;
import org.hibernate.*;
import org.hibernate.boot.Metadata;
import org.hibernate.boot.MetadataSources;
import org.hibernate.boot.registry.StandardServiceRegistry;
import org.hibernate.boot.registry.StandardServiceRegistryBuilder;  

public class FetchData {  
public static void main(String[] args) {  

	StandardServiceRegistry ssr=new StandardServiceRegistryBuilder().configure("hibernate.cfg.xml").build();
	 Metadata meta=new MetadataSources(ssr).getMetadataBuilder().build();

	 SessionFactory factory=meta.buildSessionFactory();
	 Session session=factory.openSession();

    TypedQuery query=session.createQuery("from Question");  
    List<Question> list=query.getResultList();  

    Iterator<Question> itr=list.iterator();  
    while(itr.hasNext()){  
        Question q=itr.next();  
        System.out.println("Question Name: "+q.getQname());  

        //printing answers  
        List<String> list2=q.getAnswers();  
        Iterator<String> itr2=list2.iterator();  
        while(itr2.hasNext()){  
            System.out.println(itr2.next());  
        }  

    }  
    session.close();  
    System.out.println("success");  

}  
}  

```

### 输出

![Hibernate Mapping Bag Example 3](../img/d55af98fe0bbd7172946f21bf31c94b0.png)

### [计] 下载

[Download this hibernate example (Developed using Eclipse IDE)](src/hb/mappingbag.zip)